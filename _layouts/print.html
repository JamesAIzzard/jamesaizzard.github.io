<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ page.title | default: site.title }}</title>
  <meta name="description" content="{{ page.description | default: site.description }}" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hubot+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ '/assets/css/site.css' | relative_url }}">
  <script src="{{ '/assets/js/header.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/main.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/manufacturing.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/printout.js' | relative_url }}" defer></script>

  <script>
    // Printable page behavior: make internal links open the live site
    // and normalize asset URLs so images resolve from the site root.
    document.addEventListener('DOMContentLoaded', function () {
      var LIVE = 'https://www.jai.engineer';

      // Rewrite anchors to live origin
      document.querySelectorAll('a[href]').forEach(function (a) {
        var href = a.getAttribute('href');
        if (!href) return;
        if (href.startsWith('#')) {
          a.setAttribute('href', LIVE + '/' + href);
          a.setAttribute('target', '_blank');
          a.setAttribute('rel', 'noopener');
          return;
        }
        if (href.startsWith('/')) {
          a.setAttribute('href', LIVE + href);
          a.setAttribute('target', '_blank');
          a.setAttribute('rel', 'noopener');
          return;
        }
        if (/^(\.\/|\.\.\/|assets\/?)/.test(href)) {
          try {
            var abs = new URL(href, location.origin).href;
            if (abs.startsWith(location.origin)) {
              var path = abs.replace(location.origin, '');
              a.setAttribute('href', LIVE + path);
              a.setAttribute('target', '_blank');
              a.setAttribute('rel', 'noopener');
            }
          } catch (_) { /* no-op */ }
        }
      });

      // Normalize media sources that were relative like "assets/..."
      var fixSrc = function (el, attr) {
        var val = el.getAttribute(attr);
        if (!val) return;
        if (/^(assets\/?|\.\/assets\/?|\.\.\/assets\/?)/.test(val)) {
          try {
            var absUrl = new URL(val.replace(/^\.?\/?/, '/'), location.origin);
            el.setAttribute(attr, absUrl.href);
          } catch (_) { /* no-op */ }
        }
      };
      document.querySelectorAll('img[src], source[src], video[src], audio[src]').forEach(function (el) { fixSrc(el, 'src'); });
      document.querySelectorAll('img[srcset], source[srcset]').forEach(function (el) { fixSrc(el, 'srcset'); });
    });
  </script>

  <style>
    /* Keep PDFs stable: remove animations in print */
    @media print {
      :root { color-scheme: dark; }
      html, body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      * { animation: none !important; transition: none !important; }
    }
  </style>
</head>

<body class="print-layout {{ page.body_class }}">
  {% include header.html %}
  <main>
    {{ content }}
  </main>
  {% include footer.html %}
</body>
</html>
