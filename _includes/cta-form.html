<form class="cta drop-shadow border-panel" action="https://formsubmit.co/YOUR.EMAIL@EXAMPLE.COM" method="POST"
  aria-label="Project inquiry">

  <input type="hidden" name="_subject" value="Website contact: jamesaizzard.github.io">
  <input type="hidden" name="_template" value="table">
  <input type="hidden" name="_next" value="https://jamesaizzard.github.io/contact.html#thanks">
  <input type="hidden" name="_url" value="https://jamesaizzard.github.io/contact.html">
  <input type="text" name="_honey" style="display:none">

  <label class="visually-hidden" for="project">What are you working on?</label>
  <input id="project" name="q" type="text" placeholder="What are you working on?" autocomplete="off">
  <button type="submit">Start the conversation</button>

  <div class="cta-extra" aria-hidden="false">
    <label class="visually-hidden" for="details">Add a few details (optional)</label>
    <textarea id="details" name="details" rows="4" placeholder="Add a few details (optional)"></textarea>

    <label class="visually-hidden" for="email">Your email</label>
    <input id="email" name="email" type="email" inputmode="email" autocomplete="email" placeholder="Your email *">

    <p class="cta-footnote">* I promise never to pass on your email or spam you.</p>
  </div>

  <div class="hp" aria-hidden="true">
    <label for="company" class="visually-hidden">Company (leave blank)</label>
    <input id="company" class="hp-field" type="text" name="company" tabindex="-1" autocomplete="off"
      placeholder="Company">
  </div>
</form>

<script>
  (function () {
    // Modal helpers
    function openModal(modal, opts) {
      if (!modal) return;
      const titleEl = modal.querySelector('#cta-thanks-title');
      const msgEl = modal.querySelector('.cta-modal-msg');
      const dialog = modal.querySelector('.cta-modal-dialog');
      const o = opts || {};
      if (dialog) {
        dialog.classList.remove('success', 'error');
        if (o.variant) dialog.classList.add(o.variant);
      }
      if (titleEl && o.title !== undefined) titleEl.textContent = o.title;
      if (msgEl && o.message !== undefined) msgEl.textContent = o.message;
      modal.classList.add('open');
      modal.setAttribute('aria-hidden', 'false');
      document.body.classList.add('modal-open');
      const closeBtn = modal.querySelector('.cta-modal-close');
      if (closeBtn) closeBtn.focus();
    }
    function closeModal(modal) {
      if (!modal) return;
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
      document.body.classList.remove('modal-open');
    }
    function onEsc() { /* disabled: do not close on Escape */ }

    document.querySelectorAll('form.cta').forEach(function (form) {
      if (form.__ctaBound) return; form.__ctaBound = true;
      form.addEventListener('submit', function (e) {
        e.preventDefault();
        // Resolve modal at submit-time to ensure element exists
        const modal = document.getElementById('cta-thanks');
        if (modal && !modal.__ctaModalBound) {
          modal.__ctaModalBound = true;
          const backdrop = modal.querySelector('.cta-modal-backdrop');
          const closeBtn = modal.querySelector('.cta-modal-close');
          // Keep modal open until user clicks OK
          if (backdrop) backdrop.addEventListener('click', (ev) => { ev.preventDefault(); ev.stopPropagation(); });
          if (closeBtn) closeBtn.addEventListener('click', () => closeModal(modal));
        }
        // Honeypot checks
        var hp = form.querySelector('.hp-field');
        var hp2 = form.querySelector('input[name="_honey"]');
        if ((hp && hp.value && hp.value.trim().length > 0) || (hp2 && hp2.value && hp2.value.trim().length > 0)) {
          return; // likely a bot; silently drop
        }

        // Required fields validation (email + brief subject/summary)
        var email = form.querySelector('#email');
        var subject = form.querySelector('#project');
        var missing = [];
        if (!subject || !subject.value || !subject.value.trim()) missing.push('what you are working on');
        if (!email || !email.value || !email.value.trim()) missing.push('email');
        if (missing.length) {
          openModal(modal, {
            variant: 'error',
            title: 'Almost there',
            message: 'Please add a short subject and your email so I can reply.'
          });
          return;
        }

        // Build AJAX endpoint (FormSubmit AJAX API)
        var action = form.getAttribute('action') || '';
        var endpoint = action.includes('formsubmit.co') ? action.replace('formsubmit.co/', 'formsubmit.co/ajax/') : action;
        var data = new FormData(form);

        fetch(endpoint, {
          method: 'POST',
          headers: { 'Accept': 'application/json' },
          body: data
        }).then(function (resp) {
          var ok = resp && resp.ok;
          return resp.json().catch(function () { return {}; }).then(function (json) { return { ok: ok, json: json }; });
        }).then(function (res) {
          if (res && res.ok) {
            try { form.reset(); } catch (_) { }
            if (document.activeElement && typeof document.activeElement.blur === 'function') {
              document.activeElement.blur();
            }
            form.querySelectorAll('input, textarea, button, select').forEach(function (el) {
              if (el === document.activeElement && typeof el.blur === 'function') el.blur();
            });
            openModal(modal, {
              variant: 'success',
              title: 'All set — message submitted!',
              message: 'Thanks for reaching out — I\'ll get back to you shortly.'
            });
          } else {
            openModal(modal, {
              variant: 'error',
              title: 'That didn\'t go through',
              message: 'Please try again in a moment.'
            });
          }
        }).catch(function (err) {
          console.warn('CTA submit failed:', err);
          openModal(modal, {
            variant: 'error',
            title: 'That didn\'t go through',
            message: 'Please try again in a moment.'
          });
        });
      });
    });
  })();
</script>

<!-- Modal -->
<div class="cta-modal" id="cta-thanks" aria-hidden="true">
  <div class="cta-modal-backdrop" aria-hidden="true"></div>
  <div class="cta-modal-dialog border-panel drop-shadow" role="dialog" aria-modal="true"
    aria-labelledby="cta-thanks-title" aria-describedby="cta-thanks-msg">
    <div class="cta-modal-header">
      <div class="cta-modal-glyph" aria-hidden="true"></div>
      <div class="cta-modal-text">
        <h3 id="cta-thanks-title">All set — message submitted!</h3>
        <p id="cta-thanks-msg" class="cta-modal-msg" aria-live="polite">Thanks for reaching out — I'll get back to you shortly.</p>
      </div>
    </div>
    <div class="cta-modal-actions">
      <button type="button" class="cta-modal-close">OK</button>
    </div>
  </div>
</div>
